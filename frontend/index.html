<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EMBEDDLE</title>
    <meta name="description" content="Embeddle - A multiplayer word deduction game using AI embeddings. Encrypt your word, probe enemies, eliminate targets.">
    <meta name="theme-color" content="#000000">
    
    <!-- Favicon and Icons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/manifest.json">
    
    <!-- Open Graph / Social -->
    <meta property="og:title" content="EMBEDDLE">
    <meta property="og:description" content="A multiplayer word deduction game using AI embeddings">
    <meta property="og:image" content="https://embeddle.vercel.app/og-image.png">
    <meta property="og:url" content="https://embeddle.vercel.app">
    <meta name="twitter:card" content="summary_large_image">
    
    <!-- Use absolute URLs so /game/:code routes still load assets -->
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/css/effects.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&display=swap" rel="stylesheet">
</head>
<body class="on-home-screen">
    <!-- Login Box -->
    <div id="login-box" class="login-box">
        <input type="text" id="login-name" placeholder="ENTER NAME..." maxlength="20">
        <span class="login-or">or</span>
        <button id="google-login-btn" class="btn btn-google" title="Sign in with Google">
            <svg width="18" height="18" viewBox="0 0 24 24">
                <path fill="currentColor" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                <path fill="currentColor" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                <path fill="currentColor" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                <path fill="currentColor" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
            </svg>
        </button>
    </div>
    <div id="logged-in-box" class="logged-in-box hidden">
        <button id="topbar-toggle" class="topbar-toggle" title="Toggle menu" aria-label="Toggle menu" aria-expanded="false">
            <span class="topbar-toggle-icon">▼</span>
        </button>
        <div class="topbar-content">
            <img id="user-avatar" class="user-avatar hidden" src="" alt="">
            <span id="logged-in-name">OPERATIVE</span>
            <button id="view-full-leaderboard-btn" class="btn btn-ghost btn-tiny" title="Leaderboard">[LB]</button>
            <button id="topbar-replay-btn" class="btn btn-ghost btn-tiny" title="Watch Replay">[REC]</button>
            <button id="cosmetics-btn" class="btn btn-ghost btn-tiny" title="Customise">[COS]</button>
            <button id="chat-btn" class="btn btn-ghost btn-tiny" title="Chat">[MSG]<span id="chat-unread-dot" class="unread-dot hidden"></span></button>
            <button id="info-btn" class="btn btn-ghost btn-tiny" title="Info">[?]</button>
            <button id="options-btn" class="btn btn-ghost btn-tiny" title="Options">[CFG]</button>
        </div>
    </div>

    <!-- Cosmetics Panel -->
    <div id="cosmetics-panel" class="drawer-panel cosmetics-panel">
        <div class="cosmetics-header">
            <h2>// CUSTOMISE</h2>
            <button id="close-cosmetics-btn" class="btn btn-ghost btn-tiny">×</button>
        </div>
        <div class="cosmetics-tools">
            <div class="cosmetics-preview-row">
                <div id="cosmetics-preview-card" class="player-card cosmetics-preview-card" data-player-id="cosmetics_preview">
                    <div id="cosmetics-preview-name" class="name">YOU</div>
                    <div class="status alive">Preview</div>
                </div>
            </div>
        </div>
        <div class="cosmetics-content">
            <!-- Content populated by JS -->
        </div>
    </div>

    <!-- Options Panel -->
    <div id="options-panel" class="drawer-panel options-panel">
        <div class="options-header">
            <h2>// CONFIG</h2>
            <button id="close-options-btn" class="btn btn-ghost btn-tiny">×</button>
        </div>
        <div class="options-content">
            <label class="option-row">
                <input type="checkbox" id="opt-chat-enabled">
                <span>Text chat</span>
            </label>
            <div class="option-row option-row-slider">
                <span>Music</span>
                <div class="volume-control">
                    <input type="range" id="opt-music-volume" min="0" max="100" value="12">
                    <span class="volume-value" id="music-volume-display">12%</span>
                </div>
            </div>
            <div class="option-row option-row-slider">
                <span>SFX</span>
                <div class="volume-control">
                    <input type="range" id="opt-sfx-volume" min="0" max="100" value="50">
                    <span class="volume-value" id="sfx-volume-display">50%</span>
                </div>
            </div>
            <label class="option-row">
                <input type="checkbox" id="opt-turn-notifications">
                <span>Turn notifications</span>
            </label>
            <hr class="option-divider">
            <label class="option-row">
                <input type="checkbox" id="opt-nerd-mode">
                <span>Nerd mode (show raw cosine similarity)</span>
            </label>
        </div>
    </div>

    <!-- Info Panel -->
    <div id="info-panel" class="drawer-panel info-panel">
        <div class="info-header">
            <h2>// INTEL</h2>
            <button id="close-info-btn" class="btn btn-ghost btn-tiny">×</button>
        </div>
        <div class="info-content">
            <!-- Open Source Section -->
            <div class="info-section info-opensource">
                <h3 class="info-section-title">// SOURCE_CODE</h3>
                <p class="info-desc">The code is open source, please help us improve it!</p>
                <a href="https://github.com/JamesL425/Embeddle" target="_blank" rel="noopener" class="btn btn-primary info-github-btn">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 8px;">
                        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                    </svg>
                    View on GitHub
                </a>
                <a href="https://discord.gg/ayJzrN7RtB" target="_blank" rel="noopener" class="btn btn-secondary info-discord-btn">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 8px;">
                        <path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"/>
                    </svg>
                    Join our Discord
                </a>
                <div class="info-contribute">
                    <h4>// CONTRIBUTE</h4>
                    <p>This is a community project. Get involved:</p>
                    <ul class="info-contribute-list">
                        <li><strong>Submit PRs</strong> - patches, features, fixes</li>
                        <li><strong>Report bugs</strong> - if you find a hole, flag it</li>
                        <li><strong>Add themes</strong> - expand the word databases</li>
                        <li><strong>Ideas</strong> - new modes, mechanics, whatever</li>
                    </ul>
                </div>
            </div>

            <hr class="info-divider">

            <!-- How It Works Section -->
            <div class="info-section info-how-it-works">
                <h3 class="info-section-title">// THE_TECH</h3>
                <p class="info-desc">Words exist as vectors in high-dimensional space. Similar meanings cluster together. We use OpenAI text-embedding-3-large to measure semantic distance.</p>
                
                <h4>Cosine Similarity</h4>
                <p class="info-desc-small">We measure how "close" two words are using <strong>cosine similarity</strong> - the cosine of the angle between their vectors. Raw values range from -1 (opposite) to 1 (identical).</p>
                
                <div class="info-formula">
                    <code>cosine(A, B) = (A · B) / (||A|| × ||B||)</code>
                </div>
                
                <h4>Display Transformation</h4>
                <p class="info-desc-small">Raw cosine values cluster between 20-60%, making differences hard to read. We apply a sigmoid transform to spread them across 0-100%:</p>
                
                <div class="info-formula">
                    <code>s = x<sup>n</sup> / (x<sup>n</sup> + (c(1-x))<sup>n</sup>)</code>
                    <br>
                    <small>where c = m/(1-m), m = 0.36, n = 3</small>
                </div>
                
                <p class="info-desc-small"><strong>Nerd mode</strong> (in options) shows the raw cosine similarity alongside the transformed value.</p>
                
                <h4>The Model</h4>
                <p class="info-desc-small">OpenAI text-embedding-3-large - 3072 dimensions, state-of-the-art semantic understanding.</p>
            </div>

            <hr class="info-divider">

            <!-- Ranked Section -->
            <div class="info-section info-ranked">
                <h3 class="info-section-title">// RANK_TIERS</h3>
                <p class="info-desc-small">Win ranked matches to climb. New operatives calibrate faster due to higher volatility.</p>
                
                <div class="rank-tier-table">
                    <div class="rank-tier-row">
                        <span class="rank-badge rank-master">MASTER</span>
                        <span class="rank-tier-range">2000+</span>
                    </div>
                    <div class="rank-tier-row">
                        <span class="rank-badge rank-diamond">DIAMOND</span>
                        <span class="rank-tier-range">1800 - 1999</span>
                    </div>
                    <div class="rank-tier-row">
                        <span class="rank-badge rank-platinum">PLATINUM</span>
                        <span class="rank-tier-range">1600 - 1799</span>
                    </div>
                    <div class="rank-tier-row">
                        <span class="rank-badge rank-gold">GOLD</span>
                        <span class="rank-tier-range">1400 - 1599</span>
                    </div>
                    <div class="rank-tier-row">
                        <span class="rank-badge rank-silver">SILVER</span>
                        <span class="rank-tier-range">1200 - 1399</span>
                    </div>
                    <div class="rank-tier-row">
                        <span class="rank-badge rank-bronze">BRONZE</span>
                        <span class="rank-tier-range">1000 - 1199</span>
                    </div>
                    <div class="rank-tier-row">
                        <span class="rank-badge rank-unranked">UNRANKED</span>
                        <span class="rank-tier-range">Below 1000</span>
                    </div>
                </div>
                
                <div class="rank-calibration-info">
                    <h4>Rating Calibration</h4>
                    <ul>
                        <li><strong>Placement (0-4 games):</strong> High volatility for fast calibration</li>
                        <li><strong>Provisional (5-19 games):</strong> Medium volatility as rating stabilises</li>
                        <li><strong>Established (20+ games):</strong> Normal volatility for stable ratings</li>
                    </ul>
                </div>
            </div>

            <hr class="info-divider">

            <!-- Support Section -->
            <div class="info-section info-support">
                <h3 class="info-section-title">// SUPPORT</h3>
                <p class="info-desc">Free to play. Donations cover server and API costs.</p>
                
                <div class="premium-perks">
                    <h4>// SUPPORTER_PERKS</h4>
                    <p class="info-desc-small">Supporters unlock custom theme colours and an exclusive badge. One-time donation, permanent access.</p>
                </div>
                
                <a href="https://ko-fi.com/embeddle" target="_blank" rel="noopener" class="btn btn-primary support-btn">&gt; SUPPORT</a>
                <p class="support-note">Any amount unlocks all supporter perks.</p>
            </div>
        </div>
    </div>

    <!-- Player Profile Modal -->
    <div id="profile-modal" class="modal-overlay closable-modal">
        <div class="modal-backdrop" data-close="true"></div>
        <div class="modal profile-modal">
            <button id="close-profile-btn" class="btn btn-ghost btn-tiny profile-close-btn">×</button>
            <div class="profile-banner">
                <div class="profile-banner-overlay"></div>
            </div>
            <div class="profile-header">
                <div class="profile-avatar-wrapper">
                    <img id="profile-avatar" class="profile-avatar hidden" src="" alt="">
                    <span id="profile-avatar-placeholder" class="profile-avatar-placeholder">[?]</span>
                    <span id="profile-avatar-emoji" class="profile-avatar-emoji hidden"></span>
                    <button id="edit-avatar-btn" class="edit-avatar-btn hidden" title="Change avatar">[E]</button>
                </div>
                <div class="profile-title-wrapper">
                    <div class="profile-name-row">
                        <h2 id="profile-name">Player</h2>
                        <span id="profile-badge" class="profile-badge"></span>
                    </div>
                    <span id="profile-joined" class="profile-joined"></span>
                </div>
            </div>
            <div class="profile-content">
                <div class="profile-section">
                    <h3 class="profile-section-title">// CASUAL STATS</h3>
                    <div class="profile-stats-grid">
                        <div class="profile-stat">
                            <span class="profile-stat-value" id="profile-wins">0</span>
                            <span class="profile-stat-label">Wins</span>
                        </div>
                        <div class="profile-stat">
                            <span class="profile-stat-value" id="profile-games">0</span>
                            <span class="profile-stat-label">Games</span>
                        </div>
                        <div class="profile-stat">
                            <span class="profile-stat-value" id="profile-winrate">0%</span>
                            <span class="profile-stat-label">Win Rate</span>
                        </div>
                        <div class="profile-stat">
                            <span class="profile-stat-value" id="profile-elims">0</span>
                            <span class="profile-stat-label">Eliminations</span>
                        </div>
                        <div class="profile-stat">
                            <span class="profile-stat-value" id="profile-times-eliminated">0</span>
                            <span class="profile-stat-label">Deaths</span>
                        </div>
                        <div class="profile-stat">
                            <span class="profile-stat-value" id="profile-streak">0</span>
                            <span class="profile-stat-label">Best Streak</span>
                        </div>
                    </div>
                </div>
                <div id="profile-ranked-section" class="profile-section profile-ranked-section hidden">
                    <h3 class="profile-section-title">// RANKED</h3>
                    <div id="profile-rank-tier" class="profile-rank-tier"></div>
                    <div class="profile-stats-grid profile-ranked-grid">
                        <div class="profile-stat">
                            <span class="profile-stat-value" id="profile-mmr">1000</span>
                            <span class="profile-stat-label">MMR</span>
                        </div>
                        <div class="profile-stat">
                            <span class="profile-stat-value" id="profile-peak-mmr">1000</span>
                            <span class="profile-stat-label">Peak</span>
                        </div>
                        <div class="profile-stat">
                            <span class="profile-stat-value" id="profile-ranked-record">0-0</span>
                            <span class="profile-stat-label">W-L</span>
                        </div>
                    </div>
                </div>
                <div class="profile-actions">
                    <button id="share-profile-btn" class="btn btn-secondary btn-small">
                        <span class="share-icon">&gt;</span> SHARE
                    </button>
                    <button id="profile-logout-btn" class="btn btn-danger btn-small">
                        LOGOUT
                    </button>
                </div>
                <div id="profile-loading" class="profile-loading">Loading...</div>
            </div>
        </div>
    </div>

    <!-- Avatar Picker Modal -->
    <div id="avatar-picker-modal" class="modal-overlay closable-modal">
        <div class="modal-backdrop" data-close="true"></div>
        <div class="modal avatar-picker-modal">
            <div class="modal-header">
                <h2>Choose Your Avatar</h2>
                <button id="close-avatar-picker-btn" class="btn btn-ghost btn-tiny">×</button>
            </div>
            <div class="avatar-picker-content">
                <div id="avatar-picker-grid" class="avatar-picker-grid">
                    <!-- Avatars will be populated by JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Panel -->
    <div id="chat-panel" class="drawer-panel chat-panel">
        <div class="chat-header">
            <h2>// COMMS</h2>
            <button id="close-chat-btn" class="btn btn-ghost btn-tiny">×</button>
        </div>
        <div class="chat-content">
            <div id="chat-log" class="chat-log" aria-label="Chat log"></div>
            <form id="chat-form" class="chat-form" autocomplete="off">
                <input type="text" id="chat-input" maxlength="200" placeholder="Type message..." autocomplete="off">
                <button type="submit" class="btn btn-small btn-secondary">SEND</button>
            </form>
            <p id="chat-hint" class="chat-hint">Join a match to chat.</p>
        </div>
    </div>

    <div class="matrix-bg" id="matrix-bg"></div>
    <div class="container">
        <header>
            <h1>&lt;EMBEDDLE/&gt;</h1>
            <p class="tagline">// decode. deduce. eliminate.</p>
        </header>

        <!-- Home Screen -->
        <div id="home-screen" class="screen active home-screen">
            <div class="card hero-card">
                <!-- Main Action Buttons - Big Stacked -->
                <div class="home-actions">
                    <button id="quickplay-btn" class="btn btn-primary btn-xlarge home-action">
                        <span class="btn-text">&gt; QUICK_PLAY</span>
                        <span id="quickplay-queue-count" class="queue-count hidden">0 in queue</span>
                    </button>
                    <button id="ranked-btn" class="btn btn-rank btn-xlarge home-action">
                        <span class="btn-text">&gt; RANKED</span>
                        <span id="ranked-queue-count" class="queue-count hidden">0 in queue</span>
                    </button>
                    <p id="ranked-signin-note" class="home-note-center">Ranked requires Google sign-in + 5 casual games</p>
                    
                    <!-- Secondary Options Row -->
                    <div class="home-secondary-row">
                        <button id="singleplayer-btn" class="btn btn-ghost btn-small home-action">Solo</button>
                        <span class="secondary-divider">|</span>
                        <button id="create-lobby-btn" class="btn btn-ghost btn-small home-action">Custom</button>
                        <span class="secondary-divider">|</span>
                        <div class="join-code-inline">
                            <input type="text" id="join-code-input" maxlength="6" placeholder="ENTER CODE HERE">
                            <button id="join-code-btn" class="btn btn-ghost btn-tiny">Join</button>
                        </div>
                    </div>
                </div>
                
                <!-- How It Works Section -->
                <div class="how-it-works">
                    <h3>// BRIEFING</h3>
                    <ol class="how-it-works-steps">
                        <li><strong>Select</strong> a codeword from the database</li>
                        <li><strong>Probe</strong> with guesses to reveal similarity scores</li>
                        <li><strong>Analyse</strong> patterns while masking your own</li>
                        <li><strong>Execute</strong> when you've identified a target</li>
                    </ol>
                    <p class="how-it-works-footer">Sole survivor takes the round.</p>
                </div>
                
                <!-- Footer Links -->
                <div class="home-footer-links">
                    <a href="https://ko-fi.com/embeddle" target="_blank" rel="noopener" class="home-support-link">
                        Support
                    </a>
                    <span class="secondary-divider">|</span>
                    <a href="https://github.com/JamesL425/Embeddle" target="_blank" rel="noopener" class="home-github-link">
                        GitHub
                    </a>
                    <span class="secondary-divider">|</span>
                    <a href="https://discord.gg/ayJzrN7RtB" target="_blank" rel="noopener" class="home-discord-link">
                        Discord
                    </a>
                </div>
            </div>
            
            <!-- Hidden elements needed for JS functionality -->
            <div id="recent-games" class="hidden"></div>
            <div id="open-lobbies" class="hidden"></div>
            <div id="spectate-games" class="hidden"></div>
            <div id="mini-leaderboard" class="hidden"></div>
            <input type="hidden" id="home-replay-input">
            <button id="home-replay-btn" class="hidden"></button>
            <div id="home-your-stats" class="hidden">
                <span id="home-stat-games">0</span>
                <span id="home-stat-wins">0</span>
                <span id="home-stat-elims">0</span>
                <span id="home-stat-mmr">—</span>
            </div>
            <div id="home-stats-bar" class="hidden">
                <span id="stats-streak-count">0</span>
                <span id="stats-credits">0</span>
                <span id="stats-rank">—</span>
            </div>
        </div>

        <!-- Queue Screen (Matchmaking) -->
        <div id="queue-screen" class="screen">
            <div class="card queue-card">
                <h2>// SCANNING_NETWORK</h2>
                
                <div class="queue-animation">
                    <div class="queue-radar">
                        <div class="radar-ring radar-ring-1"></div>
                        <div class="radar-ring radar-ring-2"></div>
                        <div class="radar-ring radar-ring-3"></div>
                        <div class="radar-sweep"></div>
                        <div class="radar-center"></div>
                    </div>
                </div>
                
                <div class="queue-info">
                    <div class="queue-mode-display">
                        <span class="queue-label">MODE:</span>
                        <span id="queue-mode" class="queue-value">STANDARD</span>
                    </div>
                    <div class="queue-players-display">
                        <span class="queue-label">TARGETS LOCATED:</span>
                        <span id="queue-players" class="queue-value">0</span>
                        <span class="queue-value">/</span>
                        <span id="queue-target-size" class="queue-value">4</span>
                    </div>
                    <div class="queue-timer-display">
                        <span class="queue-label">TIME IN QUEUE:</span>
                        <span id="queue-timer" class="queue-value">0:00</span>
                    </div>
                    <div id="queue-mmr-display" class="queue-mmr-display hidden">
                        <span class="queue-label">SEARCH RANGE:</span>
                        <span id="queue-mmr-range" class="queue-value">+/- 150 MMR</span>
                    </div>
                    <div id="queue-min-size-display" class="queue-min-size-display hidden">
                        <span class="queue-label">MIN PLAYERS:</span>
                        <span id="queue-min-size" class="queue-value">4</span>
                    </div>
                </div>
                
                <div class="queue-status-text">
                    <p id="queue-status-message">Establishing connection...</p>
                </div>
                
                <button id="cancel-queue-btn" class="btn btn-ghost">&lt; CANCEL</button>
            </div>
        </div>

        <!-- Leaderboard Screen -->
        <div id="leaderboard-screen" class="screen">
            <div class="card">
                <h2>// LEADERBOARDS</h2>
                <div class="button-group">
                    <button id="lb-tab-casual" class="btn btn-secondary btn-small">CASUAL</button>
                    <button id="lb-tab-ranked" class="btn btn-secondary btn-small">RANKED</button>
                </div>

                <div id="lb-casual-panel" class="leaderboard-panel">
                    <div class="button-group">
                        <button id="lb-casual-alltime" class="btn btn-ghost btn-small">ALL_TIME</button>
                        <button id="lb-casual-weekly" class="btn btn-ghost btn-small">WEEKLY</button>
                    </div>
                    <div id="casual-leaderboard-table" class="leaderboard-table-container">
                        <div class="leaderboard-empty">Loading...</div>
                    </div>
                </div>

                <div id="lb-ranked-panel" class="leaderboard-panel hidden">
                    <div id="ranked-leaderboard-table" class="leaderboard-table-container">
                        <div class="leaderboard-empty">Loading...</div>
                    </div>
                </div>

                <div class="button-group">
                    <button id="lb-back-btn" class="btn btn-ghost">&lt; BACK</button>
                </div>
            </div>
        </div>

        <!-- Join Screen (for word selection) -->
        <div id="join-screen" class="screen">
            <div class="card">
                <h2 id="join-screen-title">// CONNECT</h2>
                <div id="theme-display" class="theme-display hidden">
                    <div class="theme-header">
                        <span>DATABASE:</span>
                        <span id="theme-name" class="theme-name">Loading...</span>
                    </div>
                    <div class="theme-words-container">
                        <p class="theme-words-label">Available codewords (select one):</p>
                        <div id="theme-words" class="theme-words">
                            <!-- Words will be added here -->
                        </div>
                    </div>
                </div>
                <form id="join-form">
                    <div class="form-group" id="game-code-group">
                        <label for="game-code">SERVER_ID</label>
                        <input type="text" id="game-code" maxlength="6" placeholder="XXXXXX" required>
                    </div>
                    <div class="form-group">
                        <label for="player-name">NAME</label>
                        <input type="text" id="player-name" maxlength="20" placeholder="Enter name..." required>
                    </div>
                    <div class="form-group">
                        <label for="secret-word">CODEWORD</label>
                        <input type="text" id="secret-word" maxlength="30" placeholder="Select from database above..." required>
                        <small>This is your encrypted identity</small>
                    </div>
                    <div class="button-group">
                        <button type="submit" id="join-submit-btn" class="btn btn-primary">&gt; CONNECT</button>
                        <button type="button" id="back-home-btn" class="btn btn-ghost">&lt; ABORT</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Lobby Screen -->
        <div id="lobby-screen" class="screen">
            <div class="card">
                <h2>// SERVER_LOBBY</h2>
                <div class="game-code-display">
                    <span>ACCESS_CODE:</span>
                    <span id="lobby-code" class="code">------</span>
                    <button id="copy-code-btn" class="btn btn-small">COPY</button>
                    <span id="lobby-mode-badge" class="mode-badge casual">CASUAL</span>
                    <span id="lobby-time-badge" class="time-badge hidden">60s</span>
                </div>
                
                <!-- Theme Voting Section -->
                <div id="theme-voting-section" class="theme-voting-section">
                    <h3>SELECT DATABASE</h3>
                    <div id="theme-vote-options" class="theme-vote-options">
                        <!-- Theme options with vote counts and voter names -->
                    </div>
                </div>
                
                <div class="players-list" id="lobby-players">
                    <!-- Players will be added here -->
                </div>
                <div class="lobby-info">
                    <p>Operatives: <span id="player-count">0</span>/6</p>
                    <p class="min-players">Minimum 2 required</p>
                </div>
                <div id="host-controls" class="host-controls hidden">
                    <button id="start-game-btn" class="btn btn-primary btn-large btn-block" disabled>&gt; SELECT_WORDS</button>
                </div>
                <button id="leave-lobby-btn" class="btn btn-ghost">&lt; DISCONNECT</button>
            </div>
        </div>

        <!-- Singleplayer Lobby Screen -->
        <div id="singleplayer-lobby-screen" class="screen">
            <div class="card">
                <h2>// SOLO_MISSION</h2>
                <div class="sp-theme-display">
                    <span>DATABASE:</span>
                    <span id="sp-theme-name" class="theme-name">Loading...</span>
                </div>

                <div id="sp-theme-voting-section" class="theme-voting-section">
                    <h3>SELECT DATABASE</h3>
                    <div id="sp-theme-vote-options" class="theme-vote-options">
                        <!-- Theme options -->
                    </div>
                </div>
                
                <div class="sp-players-section">
                    <h3>OPERATIVES</h3>
                    <div id="sp-players-list" class="sp-players-list">
                        <!-- Player and AI slots will be added here -->
                    </div>
                </div>
                
                <div class="sp-ai-controls">
                    <h3>ADD AI OPPONENT</h3>
                    <div class="ai-difficulty-buttons">
                        <button class="btn btn-ai-add" data-difficulty="rookie" title="Wears a wire, drops a clue.">
                            <span class="ai-icon">[R]</span>
                            <span class="ai-label">ROOKIE</span>
                            <span class="ai-desc">Wears a wire, drops a clue.</span>
                        </button>
                        <button class="btn btn-ai-add" data-difficulty="analyst" title="Careful scans. Minimal self-leak.">
                            <span class="ai-icon">[A]</span>
                            <span class="ai-label">ANALYST</span>
                            <span class="ai-desc">Careful scans. Minimal self-leak.</span>
                        </button>
                        <button class="btn btn-ai-add" data-difficulty="field-agent" title="Balanced ops: probes, then strikes.">
                            <span class="ai-icon">[F]</span>
                            <span class="ai-label">FIELD AGENT</span>
                            <span class="ai-desc">Balanced ops: probes, then strikes.</span>
                        </button>
                        <button class="btn btn-ai-add" data-difficulty="spymaster" title="Builds a profile. Executes cleanly.">
                            <span class="ai-icon">[S]</span>
                            <span class="ai-label">SPYMASTER</span>
                            <span class="ai-desc">Builds a profile. Executes cleanly.</span>
                        </button>
                        <button class="btn btn-ai-add" data-difficulty="ghost" title="Leaves no trace. Panics into offense.">
                            <span class="ai-icon">[G]</span>
                            <span class="ai-label">GHOST</span>
                            <span class="ai-desc">Leaves no trace. Panics into offense.</span>
                        </button>
                        <button class="btn btn-ai-add btn-ai-nemesis" data-difficulty="nemesis" title="Cold. Calculated. Relentless.">
                            <span class="ai-icon">[N]</span>
                            <span class="ai-label">NEMESIS</span>
                            <span class="ai-desc">Cold. Calculated. Relentless.</span>
                        </button>
                    </div>
                </div>
                
                <div class="sp-lobby-info">
                    <p>Operatives: <span id="sp-player-count">1</span>/6</p>
                    <p id="sp-min-players" class="min-players">Add at least 1 AI target</p>
                </div>
                
                <div class="sp-host-controls">
                    <button id="sp-start-game-btn" class="btn btn-primary btn-large" disabled>&gt; START_MISSION</button>
                </div>
                <button id="sp-leave-lobby-btn" class="btn btn-ghost">&lt; SAVE &amp; EXIT</button>
            </div>
        </div>

        <!-- Word Selection Screen -->
        <div id="wordselect-screen" class="screen">
            <div class="card word-select-card">
                <h2>// SELECT_CODEWORD</h2>
                <p class="theme-label">DATABASE: <span id="wordselect-theme-name">-</span></p>
                
                <div id="word-selection-timer" class="word-selection-timer hidden">0:00</div>
                
                <div class="word-select-status">
                    <p id="word-select-status-text">Locked in: <span id="locked-count">0</span>/<span id="total-count">0</span></p>
                    <div id="player-status-list" class="player-status-list">
                        <!-- Player status will be shown here -->
                    </div>
                </div>
                
                <div id="word-select-pool" class="word-select-pool">
                    <!-- Word options will be shown here -->
                </div>
                
                <div id="word-select-controls" class="word-select-controls">
                    <span id="selected-word-display" class="selected-word-display">Click a word above</span>
                    <button id="lock-word-btn" class="btn btn-primary">&gt; LOCK_IN</button>
                </div>
                
                <div id="word-locked-notice" class="word-locked-notice hidden">
                    <p>&gt; LOCKED: <span id="locked-word-display">-</span></p>
                    <p id="waiting-text" class="waiting-text">Awaiting other operatives...</p>
                </div>
                
                <div id="host-begin-controls" class="host-begin-controls hidden">
                    <button id="begin-game-btn" class="btn btn-primary btn-large" disabled>&gt; INITIATE_BREACH</button>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="screen">
            <!-- Minimal top bar -->
            <div class="game-topbar">
                <div class="game-topbar-left">
                    <span id="game-mode-badge" class="mode-badge casual">CASUAL</span>
                    <span class="game-meta"><span id="game-theme-name">-</span></span>
                </div>
                <div class="game-topbar-center">
                    <span class="your-secret-label">Your word:</span>
                    <span id="your-secret-word" class="your-secret-value">???</span>
                </div>
                <div class="game-topbar-right">
                    <span class="round-display">R<span id="turn-number">1</span></span>
                    <button id="leave-game-btn" class="btn btn-danger btn-small">EXIT</button>
                </div>
            </div>
            
            <div class="game-layout">
                <!-- Left: Players -->
                <section class="game-players">
                    <div class="players-grid" id="players-grid">
                        <!-- Player cards will be added here -->
                    </div>
                </section>

                <!-- Center: Guess area -->
                <main class="game-center">
                    <div id="change-word-container" class="change-word-container hidden">
                        <div class="change-word-header">
                            <p class="change-word-label">&gt; Select new codeword:</p>
                            <div id="word-change-timer" class="word-change-timer hidden">
                                <span id="word-change-countdown">30</span>s
                            </div>
                        </div>
                        <div id="word-pool-options" class="word-pool-options"></div>
                        <div class="change-word-input-row">
                            <span id="new-word-display" class="selected-word-display">Click a word above</span>
                            <button id="change-word-btn" class="btn btn-small btn-accent">CONFIRM</button>
                            <button id="skip-word-change-btn" class="btn btn-small btn-ghost">KEEP</button>
                        </div>
                    </div>
                    
                    <div id="waiting-for-change" class="waiting-notice hidden">
                        &gt; <span id="waiting-player-name">Operative</span> selecting new word...
                    </div>

                    <div class="turn-indicator" id="turn-indicator">
                        <span id="turn-text">AWAITING SIGNAL...</span>
                        <span id="turn-timer" class="turn-timer hidden">--</span>
                    </div>

                    <div class="guess-section" id="guess-section">
                        <div id="guess-word-grid" class="guess-word-grid">
                            <!-- Theme words will be rendered here by JS -->
                        </div>
                        <div class="guess-selection-bar" id="guess-selection-bar">
                            <span class="guess-selected-word" id="guess-selected-word">Click a word to guess</span>
                            <button type="button" class="btn btn-primary" id="guess-submit-btn" disabled>GUESS</button>
                        </div>
                    </div>
                </main>

                <!-- Right: History log -->
                <aside class="game-log" aria-label="History">
                    <div id="game-log-host">
                        <div id="history-section" class="history-section">
                            <h3>History</h3>
                            <div id="history-log" class="history-log">
                                <!-- History entries will be added here -->
                            </div>
                        </div>
                    </div>
                </aside>
            </div>
            
            <!-- Mobile-only tabs -->
            <div class="game-mobile-tabs" id="game-mobile-tabs" role="tablist">
                <button type="button" class="game-mobile-tab active" id="game-mobile-tab-words" role="tab" aria-selected="true">GUESS</button>
                <button type="button" class="game-mobile-tab" id="game-mobile-tab-log" role="tab" aria-selected="false">LOG</button>
            </div>
            <div class="game-mobile-panels" id="game-mobile-panels">
                <div id="mobile-words-panel" class="game-mobile-panel" role="tabpanel"></div>
                <div id="mobile-log-panel" class="game-mobile-panel hidden" role="tabpanel"></div>
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="gameover-screen" class="screen">
            <div id="confetti-container" class="confetti-container"></div>
            <div class="card gameover-card">
                <div class="trophy-icon" id="trophy-icon">◈</div>
                <h2 id="gameover-title">MISSION COMPLETE</h2>
                <p id="gameover-message"></p>
                
                <!-- Action Buttons - Moved up for quick access -->
                <div class="gameover-actions">
                    <button id="play-again-btn" class="btn btn-primary btn-large">&gt; PLAY_AGAIN</button>
                    <button id="back-to-lobby-btn" class="btn btn-ghost">&lt; RETURN_TO_BASE</button>
                </div>
                
                <!-- MMR Change Display (Ranked Games Only) -->
                <div id="mmr-change-widget" class="mmr-change-widget hidden">
                    <div class="mmr-change-header">
                        <span class="mmr-label">RANK PROGRESS</span>
                        <span id="mmr-tier-badge" class="mmr-tier-badge"></span>
                    </div>
                    <div class="mmr-bar-container">
                        <div class="mmr-bar-track">
                            <div class="mmr-bar-tiers">
                                <div class="mmr-tier-segment bronze" data-tier="Bronze"></div>
                                <div class="mmr-tier-segment silver" data-tier="Silver"></div>
                                <div class="mmr-tier-segment gold" data-tier="Gold"></div>
                                <div class="mmr-tier-segment platinum" data-tier="Platinum"></div>
                                <div class="mmr-tier-segment diamond" data-tier="Diamond"></div>
                                <div class="mmr-tier-segment master" data-tier="Master"></div>
                            </div>
                            <div id="mmr-bar-fill" class="mmr-bar-fill"></div>
                            <div id="mmr-bar-marker" class="mmr-bar-marker"></div>
                        </div>
                        <div class="mmr-bar-labels">
                            <span>0</span>
                            <span>500</span>
                            <span>1000</span>
                            <span>1500</span>
                            <span>2000</span>
                            <span>2500</span>
                            <span>3000+</span>
                        </div>
                    </div>
                    <div class="mmr-value-display">
                        <span id="mmr-value-current" class="mmr-value-current">1000</span>
                        <span id="mmr-delta-float" class="mmr-delta-float"></span>
                    </div>
                    <div id="rank-up-banner" class="rank-up-banner hidden">
                        <span class="rank-up-text">RANK UP!</span>
                        <span id="rank-up-tier" class="rank-up-tier"></span>
                    </div>
                </div>
                
                <div class="revealed-words" id="revealed-words">
                    <!-- All secret words revealed -->
                </div>
                
                <!-- Share Results Section - Compact -->
                <div class="share-results-section share-results-compact">
                    <div class="share-buttons-row">
                        <button id="copy-results-btn" class="btn btn-ghost btn-small">Copy</button>
                        <button id="share-twitter-btn" class="btn btn-ghost btn-small">Share</button>
                        <button id="watch-replay-btn" class="btn btn-ghost btn-small">Replay</button>
                        <button id="share-replay-btn" class="btn btn-ghost btn-small">Link</button>
                    </div>
                </div>
                
                <!-- Support Prompt (shown for non-donors after 3+ games) -->
                <div id="gameover-support-prompt" class="gameover-support-prompt hidden">
                    <p>Like the game? Support keeps it running.</p>
                    <a href="https://ko-fi.com/embeddle" target="_blank" rel="noopener" class="btn btn-small btn-support">Support on Ko-fi</a>
                    <button id="dismiss-support-prompt" class="btn btn-ghost btn-tiny" title="Dismiss">×</button>
                </div>
            </div>
        </div>

        <!-- Replay Screen (Full Screen Viewer) -->
        <div id="replay-screen" class="screen replay-screen">
            <div class="replay-layout">
                <!-- Replay Header -->
                <div class="replay-screen-header">
                    <div class="replay-title-section">
                        <h2>// REPLAY</h2>
                        <span id="replay-screen-theme" class="replay-screen-theme">Theme: —</span>
                    </div>
                    <button id="replay-back-btn" class="btn btn-ghost btn-small">← BACK</button>
                </div>

                <!-- Main Replay Content -->
                <div class="replay-main">
                    <!-- Player Cards Grid -->
                    <div id="replay-screen-players" class="replay-screen-players">
                        <!-- Player cards will be rendered here -->
                    </div>

                    <!-- Current Turn Display -->
                    <div class="replay-screen-turn-display">
                        <div id="replay-screen-turn-counter" class="replay-screen-turn-counter">Turn 0 / 0</div>
                        <div id="replay-screen-current-turn" class="replay-screen-current-turn">
                            <div class="replay-turn-info">Game start</div>
                        </div>
                    </div>

                    <!-- Playback Controls -->
                    <div class="replay-screen-controls">
                        <button id="replay-screen-prev" class="btn btn-secondary btn-small">&lt; PREV</button>
                        <button id="replay-screen-play" class="btn btn-primary">&gt; PLAY</button>
                        <button id="replay-screen-next" class="btn btn-secondary btn-small">NEXT &gt;</button>
                    </div>

                    <!-- Timeline Slider -->
                    <div class="replay-screen-timeline">
                        <input type="range" id="replay-screen-slider" min="0" max="0" value="0">
                    </div>
                </div>

                <!-- Share Section -->
                <div class="replay-share-section">
                    <h3>// SHARE_REPLAY</h3>
                    <div class="replay-share-buttons">
                        <button id="replay-copy-link-btn" class="btn btn-secondary btn-small">COPY LINK</button>
                        <button id="replay-copy-code-btn" class="btn btn-secondary btn-small">COPY CODE</button>
                    </div>
                    <div class="replay-load-section">
                        <input type="text" id="replay-load-input" placeholder="Paste replay code..." class="replay-code-input">
                        <button id="replay-load-btn" class="btn btn-small btn-secondary">LOAD</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Replay Modal -->
        <div id="replay-modal" class="modal-overlay">
            <div class="modal replay-modal">
                <div class="replay-header">
                    <h2>// REPLAY</h2>
                    <button id="close-replay-btn" class="btn btn-ghost btn-tiny">×</button>
                </div>
                <div class="replay-info">
                    <span id="replay-theme" class="replay-theme"></span>
                    <span id="replay-turn-counter" class="replay-turn-counter">Turn 0/0</span>
                </div>
                <div id="replay-players" class="replay-players">
                    <!-- Player cards will be inserted here -->
                </div>
                <div id="replay-current-turn" class="replay-current-turn">
                    <!-- Current turn info -->
                </div>
                <div class="replay-controls">
                    <button id="replay-prev" class="btn btn-secondary btn-small">&lt; PREV</button>
                    <button id="replay-play" class="btn btn-primary btn-small">&gt; PLAY</button>
                    <button id="replay-next" class="btn btn-secondary btn-small">NEXT &gt;</button>
                </div>
                <div class="replay-timeline">
                    <input type="range" id="replay-slider" min="0" max="0" value="0">
                </div>
            </div>
        </div>

        <!-- Footer with Support Links -->
        <footer class="site-footer">
            <div class="footer-content">
                <span class="footer-text">// EMBEDDLE v1.0</span>
                <div class="footer-links">
                    <a href="https://github.com/JamesL425/Embeddle" target="_blank" rel="noopener" class="footer-link github-link">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" style="vertical-align: middle; margin-right: 4px;">
                            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                        </svg>
                        GitHub
                    </a>
                    <a href="https://discord.gg/ayJzrN7RtB" target="_blank" rel="noopener" class="footer-link discord-link">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" style="vertical-align: middle; margin-right: 4px;">
                            <path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"/>
                        </svg>
                        Discord
                    </a>
                    <a href="https://ko-fi.com/embeddle" target="_blank" rel="noopener" class="footer-link support-link">
                        Support
                    </a>
                    <a href="/privacy" class="footer-link">Privacy</a>
                    <a href="/terms" class="footer-link">Terms</a>
                </div>
            </div>
        </footer>
    </div>

    <!-- Custom Lobby Modal -->
    <div id="custom-lobby-modal" class="modal-overlay closable-modal">
        <div class="modal-backdrop" data-close="true"></div>
        <div class="modal custom-lobby-modal">
            <div class="modal-header">
                <h2>// CREATE_CUSTOM_LOBBY</h2>
                <button id="close-custom-lobby-btn" class="btn btn-ghost btn-tiny">×</button>
            </div>
            <div class="modal-content">
                <div class="form-group">
                    <label>VISIBILITY</label>
                    <div class="visibility-toggle">
                        <button type="button" id="visibility-public" class="visibility-btn active" data-value="public">PUBLIC</button>
                        <button type="button" id="visibility-private" class="visibility-btn" data-value="private">PRIVATE</button>
                    </div>
                    <p class="form-hint" id="visibility-hint">Anyone can join from Active Servers</p>
                </div>
                <div class="form-group">
                    <label for="custom-time-control">TIME CONTROL</label>
                    <select id="custom-time-control" class="time-control-select">
                        <option value="bullet">Bullet (1 min + 1s)</option>
                        <option value="blitz">Blitz (2 min + 2s)</option>
                        <option value="rapid" selected>Rapid (5 min + 3s)</option>
                        <option value="classical">Classical (10 min + 5s)</option>
                        <option value="none">No Limit</option>
                    </select>
                </div>
                <div class="modal-buttons">
                    <button id="create-custom-lobby-confirm" class="btn btn-primary">&gt; CREATE_LOBBY</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Leave Game Modal -->
    <div id="leave-game-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="leave-game-title">
        <div class="modal-backdrop" data-close="true"></div>
        <div class="modal-card">
            <h2 id="leave-game-title">// LEAVE_GAME</h2>
            <p class="modal-text">Are you sure? Leaving will forfeit your current match.</p>
            <div class="button-group">
                <button id="leave-game-exit" class="btn btn-primary">&gt; EXIT</button>
                <button id="leave-game-confirm" class="btn btn-danger">&gt; FORFEIT</button>
                <button id="leave-game-cancel" class="btn btn-secondary">CANCEL</button>
            </div>
        </div>
    </div>

    <!-- Username Setup Modal -->
    <div id="username-modal" class="modal-overlay" style="display: none;">
        <div class="modal-backdrop"></div>
        <div class="modal username-modal">
            <div class="username-modal-header">
                <h2>// NAME</h2>
            </div>
            <div class="username-modal-content">
                <p class="username-modal-description">Pick a unique name for your operative profile. This will be displayed to other players instead of your Google account name.</p>
                <div class="username-input-group">
                    <input type="text" id="username-input" placeholder="Enter name..." maxlength="20" autocomplete="off" spellcheck="false">
                    <span id="username-char-count" class="username-char-count">0/20</span>
                </div>
                <p id="username-error" class="username-error hidden"></p>
                <p class="username-rules">3-20 characters. Letters, numbers, underscores, and hyphens only.</p>
                <div class="username-modal-buttons">
                    <button id="username-submit-btn" class="btn btn-primary" disabled>&gt; CONFIRM NAME</button>
                    <button id="username-skip-btn" class="btn btn-ghost btn-small">Skip for now</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Name Prompt Modal (lazy name entry) -->
    <div id="name-prompt-modal" class="modal-overlay closable-modal" style="display: none;">
        <div class="modal-backdrop" data-close="true"></div>
        <div class="modal name-prompt-modal">
            <div class="name-prompt-header">
                <h2>// ENTER_NAME</h2>
            </div>
            <div class="name-prompt-content">
                <p class="name-prompt-description">Choose a name to identify yourself in the game.</p>
                <div class="name-prompt-input-group">
                    <input type="text" id="name-prompt-input" placeholder="Enter name..." maxlength="20" autocomplete="off" spellcheck="false">
                </div>
                <p id="name-prompt-error" class="name-prompt-error hidden"></p>
                <div class="name-prompt-buttons">
                    <button id="name-prompt-submit" class="btn btn-primary">&gt; CONTINUE</button>
                    <button id="name-prompt-cancel" class="btn btn-ghost">CANCEL</button>
                </div>
            </div>
        </div>
    </div>

    <script src="/js/text.js"></script>
    <script src="/cosmetics.js"></script>
    <script src="/app.js"></script>
</body>
</html>
